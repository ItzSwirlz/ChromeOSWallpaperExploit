# ChromeOSWallpaperExploit
Bypass for an organization restricting a user to set wallpapers on their own Chrome OS systems. Found May 3rd, Disclosed to public May 12th 2022

**This may be a security vulnerability**

On Chrome OS, an organization can set policies. One of them is to set a default wallpaper that users cannot change. Despite from the general settings app, the personalization app being unaccessible, if it is still in the launcher a user can force the system to change the wallpaper using the "Change Daily" option, and from there gain privileges to access wallpaper controls. If left unchecked, this could open the door for other areas of the system to be exposed. **As of May 12 2022 this may have been fixed but needs to be checked.**

## Steps

1) Press the Everything button (The button on the left in between Tab and Shift that looks like a magnifying glass)
Type “Wallpaper” and hit enter. This will bypass the lock that prevents you from accessing the Wallpaper settings from the general OS settings.

2) If you directly set a wallpaper, it will not work and you will be alerted of it. But, using the Change Daily option you can regain privileges (privilege escalation).
Click one of the preset/bundled wallpaper albums - e.g. Cityscapes.
Press the ‘Change Daily’ button. Since Chrome OS (root) sets this wallpaper, the organization cannot.

**You now have your Entrypoint. From here, you can now select any wallpaper, and successfully apply them (In the Cityscapes album or custom images). The app does not know this and will still alert you anyways claiming it did not work.**


## Summary
Potentially a privilege escalation is occuring as the permission to set a wallpaper that changes daily has gone unchecked, giving the application root (head of system) permissions, overriding system/organization/group requirements.

- Joshua Peisach, 5/3/22
Vulnerability Disclosed to Public: 5/12/22
